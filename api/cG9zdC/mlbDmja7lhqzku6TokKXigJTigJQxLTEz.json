{"title":"数据冬令营——1.13","date":"2018-01-13T05:40:35.000Z","slug":"数据冬令营——1-13","updated":"2018-06-30T13:24:01.504Z","content":"<p>今天的课程又结束了，好快啊……<br>今天上午课程依旧python，scrapy框架……这个在这里就不记述了。<br>几天下午学习的vba在很大程度上又开启了我另一个世界<br>太神奇了。太赞了！<br><br><br>下面记述一下，如何在vba中实现汇总word文章中不同表的内容资料：</p>\n<p><code>` Sub 汇总所有数据() \n    &#39;定义所有变量\n    Dim ff As String, path As String, a As Integer, Filename As String\n    &#39;定义等会窗口中过滤出的文件类型\n    ff = &quot;Word文档(*.doc;*.docx),*.doc;*.docx &quot;\n    &#39;窗口中左上角显示文字\n    strtitle = &quot;打开Word文档&quot;\n    &#39;选择后取路径，并赋值到path中\n    path = Application.GetOpenFilename(filefilter:=ff, Title:=strtitle)\n    &#39;将“路径”中的路径和文件名整体分开\n    a = Len(path)\n     For i = 1 To a\n     &#39;从右开始直到截取到\\，才执行if程序中内容\n      If Mid(Right(path, i), 1, 1) = &quot;\\&quot; Then\n      path = Mid(path, 1, a - i + 1)\n      Exit For\n      End If\n    Next\n    &#39;按照dir排序path所有文件名\n    Filename = Dir(path)\n    &#39;循环查找word文件中table中的指定值，输出到excel中\n    k = 2\n    &#39;开始循环，文件不为空，直接开始循环\n    Do While Filename &lt;&gt; &quot;&quot;\n     &#39;下面这一条固定，表示word应用程序（docapp）被创建,同样每一循环都必须打开word\n     Set docapp = CreateObject(&quot;Word.application&quot;)\n     &#39;创建对象，打开word文档\n     Set dd = docapp.documents.Open(path &amp; Filename)\n     &#39;创建对象，附上文档中的第一个表格table\n     Set ddd1 = dd.Tables(1)\n     Set ddd2 = dd.Tables(2)\n     &#39;计算表格中行数\n     x = ddd2.Range.Rows.Count\n     For i = 2 To x    &#39;i为word中表格的行数\n      Cells(k, 1) = Mid(ddd1.cell(1, 2).Range, 1, Len(ddd1.cell(1, 2).Range) - 2)\n      Cells(k, 2) = Mid(ddd2.cell(i, 2).Range, 1, Len(ddd2.cell(i, 2).Range) - 2)\n      Cells(k, 3) = Mid(ddd1.cell(1, 4).Range, 1, Len(ddd1.cell(1, 4).Range) - 2)\n      Cells(k, 4) = Mid(ddd1.cell(1, 6).Range, 1, Len(ddd1.cell(1, 6).Range) - 2)\n      Cells(k, 5) = Mid(ddd1.cell(2, 4).Range, 1, Len(ddd1.cell(2, 4).Range) - 2)\n      Cells(k, 6) = Mid(ddd1.cell(3, 4).Range, 1, Len(ddd1.cell(3, 4).Range) - 2)\n      Cells(k, 7) = Mid(ddd2.cell(i, 3).Range, 1, Len(ddd2.cell(i, 3).Range) - 2)\n      k = k + 1      &#39;k为输出到的表格行数\n     Next\n     &#39;开完一个文档后，各种关闭和归零\n     dd.Close\n    docapp.Quit\n     Set docapp = Nothing\n     Set dd = Nothing\n     Set ddd1 = Nothing\n     Set ddd2 = Nothing\n     &#39;文件到下一个\n     Filename = Dir\n     Loop\n     &#39;所有文件读取完后，手动修改第一行\n     Cells(1, 1) = &quot;姓名&quot;\n     Cells(1, 2) = &quot;日期&quot;\n     Cells(1, 3) = &quot;性别&quot;\n     Cells(1, 4) = &quot;学历&quot;\n     Cells(1, 5) = &quot;工资&quot;\n     Cells(1, 6) = &quot;年龄&quot;\n     Cells(1, 7) = &quot;销售客单&quot;\n    End Sub</code></p>\n<div class=\"article-img\"><p><img src=\"../images/2018.1/x1.png\" alt=\"&quot;汇总结果图&quot;\"></p></div>\n<p><br><br>下面是特殊效果，模块代码实现不同行列实现颜色区别：</p>\n<div class=\"article-img\"><p><img src=\"../images/2018.1/x2.png\" alt=\"&quot;颜色图&quot;\"></p></div>\n<p>再通过放在用户中appdata中roaming，其中的微软的excel中文件下。<br>在通过设置excel软件下的“项目”。添加可信任位置。设置便捷按键（？）<br>实现快捷“色彩阅读模式”<br><br><br>下面是部分abv图片：</p>\n<p><img src=\"../images/2018.1/1.png\" alt=\"&quot;插入数据图&quot;\"><br><img src=\"../images/2018.1/2.png\" alt=\"&quot;计算图&quot;\"></p>\n","prev":{"title":"三天兼职小记","slug":"三天兼职小记"},"next":{"title":"数据冬令营———1.12思考","slug":"数据冬令营———1-12思考"},"link":"http://yoursite.com/post/数据冬令营——1-13/"}